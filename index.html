<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gamify Life</title>
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/dashboard.css" />
    <!-- All your page content here -->

    <!-- ADD THIS RIGHT BEFORE </body> -->
    <!-- Firebase SDKs + Auth + Login UI -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>

    <script>
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyD_XLcVP2KSynm19akbXJOmt-bAMqOJ_2U",
        authDomain: "gamify-life-2025.firebaseapp.com",
        projectId: "gamify-life-2025",
        storageBucket: "gamify-life-2025.firebasestorage.app",
        messagingSenderId: "67156140086",
        appId: "1:67156140086:web:1a2d8593998bbaa463b897",
        measurementId: "G-L9KEJTSDJ1",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      let currentUser = null;

      firebase.auth().onAuthStateChanged((user) => {
        currentUser = user;
        if (user) {
          document.body.classList.add("logged-in");
          document.getElementById("login-box")?.remove();
          loadUserData?.(); // will exist on pages that have it
        } else {
          document.body.classList.remove("logged-in");
          showLogin();
        }
      });

      function showLogin() {
        if (document.getElementById("login-box")) return;
        const box = document.createElement("div");
        box.id = "login-box";
        box.style =
          "position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:3rem;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,0.4);z-index:9999;text-align:center;font-family:inherit;";
        box.innerHTML = `
        <h2>Welcome to Gamify Life</h2>
        <p>Sign in to save your data across devices</p>
        <input id="email" placeholder="Email" style="width:280px;padding:1rem;margin:0.5rem;font-size:1.1rem;border-radius:12px;border:1px solid #ccc;"><br>
        <input id="password" type="password" placeholder="Password" style="width:280px;padding:1rem;margin:0.5rem;font-size:1.1rem;border-radius:12px;border:1px solid #ccc;"><br>
        <button onclick="login()" style="margin:0.5rem;padding:1rem 2rem;background:#155e3b;color:white;border:none;border-radius:12px;cursor:pointer;">Log In</button>
        <button onclick="signup()" style="margin:0.5rem;padding:1rem 2rem;background:#2d6a4f;color:white;border:none;border-radius:12px;cursor:pointer;">Sign Up</button>
        <button onclick="googleLogin()" style="margin:0.5rem;padding:1rem 2rem;background:#4285f4;color:white;border:none;border-radius:12px;cursor:pointer;">Google</button>
        <p><small>or <a href="#" onclick="this.closest('#login-box').remove()">continue as guest</a> (no save)</small></p>
      `;
        document.body.appendChild(box);
      }

      window.login = () =>
        firebase
          .auth()
          .signInWithEmailAndPassword(
            document.getElementById("email").value,
            document.getElementById("password").value
          )
          .catch((e) => alert(e.message));
      window.signup = () =>
        firebase
          .auth()
          .createUserWithEmailAndPassword(
            document.getElementById("email").value,
            document.getElementById("password").value
          )
          .catch((e) => alert(e.message));
      window.googleLogin = () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider);
      };
    </script>
  </head>

  <body class="dashboard">
    <a href="/index.html" class="btn btn--home">Home</a>

    <div class="dashboard__inner">
      <h1 class="dashboard__title">Gamify Life</h1>
      <div class="dashboard__grid">
        <a href="/2-minute-blitz.html" class="dashboard__link link--blitz"
          >2-Minute Blitz</a
        >
        <a href="/lifestyle-goals.html" class="dashboard__link link--lifestyle"
          >Lifestyle/Goals</a
        >
        <!-- add more buttons here later with their own colors -->
        <a href="#">Daily Quests</a>
        <a href="#">Recurring Quests</a>
        <a href="#">All Quests</a>
        <a href="#">Deep Cleaning List</a>
        <a href="#">XP System</a>
        <a href="#">Power Ups</a>
        <a href="#">World Map</a>
        <a href="#">Avatar Levels</a>
        <a href="#">Avatar Cards</a>
        <!-- add more buttons here later with their own colors -->
      </div>
    </div>
  </body>
</html>
